
-- Create view showing tank data short info

DROP VIEW [dbo].[tankInfoShort]
GO
CREATE VIEW [dbo].[tankInfoShort]
AS
SELECT        dbo.tank.tankId AS TankID, dbo.tank.name AS Tank, dbo.tankType.name AS Tanktype, dbo.country.name AS Country
FROM            dbo.country INNER JOIN
                         dbo.tank ON dbo.country.countryId = dbo.tank.countryId INNER JOIN
                         dbo.tankType ON dbo.tank.tankTypeId = dbo.tankType.tankTypeID
GO

-- Create view showing user tanks, short tank info and battle count

DROP VIEW [dbo].[userTankInfoBattleCount]
GO
CREATE VIEW [dbo].[userTankInfoBattleCount]
AS
SELECT        dbo.wotUser.name AS Username, dbo.tank.name AS Tank, dbo.tankType.name AS Tanktype, dbo.country.name AS Country, 
                         dbo.userTank.battles15 AS [Battles 15x15], dbo.userTank.battles7 AS [Battles 7x7]
FROM            dbo.userTank INNER JOIN
                         dbo.wotUser ON dbo.userTank.wotUserId = dbo.wotUser.wotUserId INNER JOIN
                         dbo.tank ON dbo.userTank.tankId = dbo.tank.tankId INNER JOIN
                         dbo.tankType ON dbo.tank.tankTypeId = dbo.tankType.tankTypeID INNER JOIN
                         dbo.country ON dbo.tank.countryId = dbo.country.countryId
GO

-- Create view for simulating one PK on jsonUserTank table

DROP VIEW [dbo].[jsonUserTankView]
GO
CREATE VIEW [dbo].[jsonUserTankView]
AS
SELECT        Concat(dbo.jsonUserTank.jsonMain, '.', dbo.jsonUserTank.jsonSub, '.', dbo.jsonUserTank.jsonProperty) as jsonMainSubProperty,  dbo.jsonUserTank.dbField, dbo.jsonUserTank.dataType
FROM          dbo.jsonUserTank
GO


-- Joined radios and tanks

create view tankRadioView
as
select 
  t.name as tank,
  r.name as radio,
  r.tier as tier,
  r.signalRange as signalRange
from 
  radio r 
  left join tankRadio tr on r.radioId = tr.radioId
  left join tank t on tr.tankId = t.tankId
go